"use strict";(self.webpackChunkangular_portfolio=self.webpackChunkangular_portfolio||[]).push([[755],{2755:(x,b,g)=>{g.r(b),g.d(b,{AntsComponent:()=>N});var f=g(3791),M=g(4520);class C{constructor(i,t){this.demoCanvas=i,this.worldManager=t,this._cells=[],this._cellLength=16,this.pheromoneMax=1e3,this.DEFAULT_DECAY_RATE=.001,this.DEFAULT_DIFFUSION_RATE=.002,this.decayRate=this.DEFAULT_DECAY_RATE,this.diffusionRate=this.DEFAULT_DIFFUSION_RATE,this.resetCells()}reset(){this.resetCells(),this.canvas.clear()}resetCells(){for(let i=0;i<this.height;i++){this._cells[i]=[];for(let t=0;t<this.width;t++){const e=this.getCellPosition(i,t);this._cells[i][t]=new y(i,t,e)}}}addToCanvas(){this.canvas=new M.TC,this.canvas.position.set(0,0),this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,this.demoCanvas.addChildToStage(this.canvas)}get width(){return Math.round(this.canvasWidth/this._cellLength)}get height(){return Math.round(this.canvasHeight/this._cellLength)}get canvasWidth(){return this.demoCanvas.width}get canvasHeight(){return this.demoCanvas.height}get cellLength(){return this._cellLength}get cells(){return this._cells}getCell(i){let t=Math.round(i.x/this._cellLength);t<0&&(t=0),t>=this.width&&(t=this.width-1);let e=Math.round(i.y/this._cellLength);return e<0&&(e=0),e>=this.height&&(e=this.height-1),this._cells[e][t]}getCellPosition(i,t){return new f.W(t*this._cellLength,i*this._cellLength)}overwriteCells(i){this._cells=i}decayPheromones(){for(let i=0;i<this.height;i++)for(let t=0;t<this.width;t++){const e=this.cells[i][t];if(!this.worldManager.isOnFood(e.position)&&!this.worldManager.isOnNest(e.position))for(const s in l){const n=1*e.getPheromone(l[s])-this.decayRate;e.setPheromone(l[s],n)}}}diffusePheromones(){const i=new C(this.demoCanvas,this.worldManager);for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const s=e-1>=0,n=t-1>=0,r=e+1<this.width,d=t+1<this.height,c=i._cells[t][e];if(r){const a=i._cells[t][e+1],A=this._cells[t][e];if(c.addOtherCellsPheromones(this._cells[t][e+1]),a.addOtherCellsPheromones(A),n){const p=this._cells[t-1][e+1],w=this._cells[t-1][e];c.addOtherCellsPheromones(p),a.addOtherCellsPheromones(w),a.addOtherCellsPheromones(p)}if(d){const p=this._cells[t+1][e+1],w=this._cells[t+1][e];c.addOtherCellsPheromones(p),a.addOtherCellsPheromones(w),a.addOtherCellsPheromones(p)}}if(!s&&d){const a=i._cells[t+1][e],A=this._cells[t][e];if(c.addOtherCellsPheromones(this._cells[t+1][e]),a.addOtherCellsPheromones(A),r){const w=this._cells[t+1][e+1];a.addOtherCellsPheromones(this._cells[t][e+1]),a.addOtherCellsPheromones(w)}}const u=1-this.diffusionRate;for(const a in l){let m=this._cells[t][e].getPheromone(l[a])*u;m+=i._cells[t][e].getPheromone(l[a])*this.diffusionRate/8,i._cells[t][e].setPheromone(l[a],m<.05?0:m)}}this.overwriteCells(i._cells)}drawPheromones(){this.canvas.clear();for(let i=0;i<this.height;i++)for(let t=0;t<this.width;t++)this.drawPheromone(i,t,65280,this._cells[i][t].getPheromone(l.Nest)),this.drawPheromone(i,t,255,this._cells[i][t].getPheromone(l.Food))}drawPheromone(i,t,e,s){if(0==s)return;const n=(s=Math.min(s,this.pheromoneMax))/this.pheromoneMax*.5,r=this.getCellPosition(i,t);this.canvas.beginFill(e,n),this.canvas.drawRect(r.x,r.y,this._cellLength/2,this._cellLength/2),this.canvas.endFill()}getFrontalCells(i,t){const e=[],s=this.cells,n=i.row,r=i.col,d=n-1>=0,c=n+1<this.height,u=r-1>=0,a=r+1<this.width;switch(t){case 0:if(!d||!c||!a)return;e.push(s[n-1][r+1]),e.push(s[n][r+1]),e.push(s[n+1][r+1]);break;case 45:if(!d||!a)return;e.push(s[n-1][r]),e.push(s[n-1][r+1]),e.push(s[n][r+1]);break;case 90:if(!d||!u||!a)return;e.push(s[n-1][r-1]),e.push(s[n-1][r]),e.push(s[n-1][r+1]);break;case 135:if(!d||!u)return;e.push(s[n][r-1]),e.push(s[n-1][r-1]),e.push(s[n-1][r]);break;case 180:if(!d||!c||!u)return;e.push(s[n+1][r-1]),e.push(s[n][r-1]),e.push(s[n-1][r-1]);break;case 225:if(!c||!u)return;e.push(s[n+1][r]),e.push(s[n+1][r-1]),e.push(s[n][r-1]);break;case 270:if(!c||!u||!a)return;e.push(s[n+1][r+1]),e.push(s[n+1][r]),e.push(s[n+1][r-1]);break;case 315:if(!c||!a)return;e.push(s[n][r+1]),e.push(s[n+1][r+1]),e.push(s[n+1][r])}return e}getNeighborCells(i){const t=[];for(let e=-1;e<=1;e++)for(let s=-1;s<=1;s++){const n=i.row+e,r=i.col+s;n<0||n>=this.height||r<0||r>=this.width||0==e&&0==s||t.push(this.worldManager.grid.cells[n][r])}return t}}var l=(()=>{return(h=l||(l={})).Food="Food",h.Nest="Nest",l;var h})();class y{constructor(i,t,e){this.pheromones=new Map([[l.Food,0],[l.Nest,0]]),this._row=i,this._col=t,this._position=e}get row(){return this._row}get col(){return this._col}get position(){return this._position}getPheromone(i){return this.pheromones.get(i)}setPheromone(i,t){this.pheromones.set(i,t)}addPheromone(i,t){this.pheromones.set(i,this.pheromones.get(i)+t)}addOtherCellsPheromones(i){for(const t in l)this.addPheromone(l[t],i.getPheromone(l[t]))}}var o=g(2096),P=g(2668);class _ extends PIXI.Graphics{constructor(i,t,e,s){super(),this.beginFill(s),this.drawCircle(0,0,e),this.endFill(),this.position.set(i,t),this.circle=new PIXI.Circle(i,t,e)}containsVector2D(i){return this.circle.contains(i.x,i.y)}getPosition(){return new f.W(this.x,this.y)}setPosition(i){this.position.set(i.x,i.y)}get radius(){return this.circle.radius}set radius(i){this.circle.radius=i}}PIXI;let T=(()=>{class h{constructor(t){this.demoCanvas=t,this.timeSincePheromoneUpdate=0,this.diffusePheromonesDelay=250}init(){this.initGrid();const t=Math.min(this.demoCanvas.width,this.demoCanvas.height),e=.2*t,s=.1*t;this.initNest(e,e,s),this.initFood(this.demoCanvas.width-e,this.demoCanvas.height-e,s)}initGrid(){this.grid=new C(this.demoCanvas,this),this.grid.addToCanvas()}initNest(t,e,s){this.nest=new _(t,e,s,52224),this.demoCanvas.addChildToStage(this.nest)}initFood(t,e,s){this.food=new _(t,e,s,204),this.demoCanvas.addChildToStage(this.food)}update(t){null!=this.previousUpdateTimeStamp?(this.timeSincePheromoneUpdate+=t-this.previousUpdateTimeStamp,this.timeSincePheromoneUpdate>=this.diffusePheromonesDelay&&(this.timeSincePheromoneUpdate=0,this.grid.decayPheromones(),this.grid.diffusePheromones(),this.grid.drawPheromones())):this.previousUpdateTimeStamp=t}isOnFood(t){return this.food.containsVector2D(t)}isOnNest(t){return this.nest.containsVector2D(t)}onSliderClicked(t){const e=t.target,n=+e.value/100;switch(e.id){case"decay-slider":this.grid.decayRate=2*this.grid.DEFAULT_DECAY_RATE*n,this.grid.decayRate>1&&(this.grid.decayRate=1),console.log(`Set decay rate to ${this.grid.decayRate}`);break;case"diffusion-slider":this.grid.diffusionRate=2*this.grid.DEFAULT_DIFFUSION_RATE*n,this.grid.diffusionRate>1&&(this.grid.diffusionRate=1),console.log(`Set diffusion rate to ${this.grid.diffusionRate}`)}}reset(){this.grid.reset()}}return h.\u0275fac=function(t){return new(t||h)(o.LFG(P.B))},h.\u0275prov=o.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();var v=g(2862),F=g(3336);class Z extends F.p{constructor(i,t){super(i),this.hasFood=!1,this.timeSincePheromoneDrop=0,this.dropPheromoneDelay=125,this.maxSpeed=1,this.width=48,this.height=48,this.anchor.set(.5,.5),this.worldManager=t,this.init()}init(){this.initPosition(),this.initAngle(),this.initVelocity(),this.hasFood=!1,this.desiredDirection=this.velocity}initPosition(){const i=this.worldManager.nest;this.setPosition(new f.W(v.d.getRandomIntInclusive(i.x-i.radius+this.width/2,i.x+i.radius-this.width/2),v.d.getRandomIntInclusive(i.y-i.radius+this.height/2,i.y+i.radius-this.height/2)))}initAngle(){this.setAngle(v.d.getRandomIntInclusive(0,360))}initVelocity(){const i=this.getAngle()*M.ZX,t=Math.cos(i)*this.maxSpeed,e=Math.sin(i)*this.maxSpeed;this.velocity=new f.W(t,e)}move(i){this.targetPheromones(),this.update(i),this.keepWithinBounds();const t=this.getPosition().addVector2D(this.velocity);this.setPosition(t),this.updateAnimation(i,2400,this.movementSpeed),this.setAngleFromVelocity(),this.dropPheromones(i)}targetPheromones(){if(this.hasFood){const i=this.worldManager.isOnFood(this.getPosition());this.updateTargetDirection(i,l.Nest)}else{const i=this.worldManager.isOnNest(this.getPosition());this.updateTargetDirection(i,l.Food)}}updateTargetDirection(i,t){const e=this.worldManager.grid.getCell(this.getPosition());let s=null;if(!i){const n=this.worldManager.grid.getFrontalCells(e,this.getClosestHeading());null!=n&&(s=this.getCellWithHighestPheromone(n,t))}if(null==s){const n=this.worldManager.grid.getNeighborCells(e);s=this.getCellWithHighestPheromone(n,t)}null!=s&&s.getPheromone(t)>0&&(this.desiredDirection=s.position.subtractVector2D(this.getPosition()))}getClosestHeading(){const i=this.getAngle();let t=0;for(let e=0;e<360;e+=45)Math.abs(e-i)<=Math.abs(t-i)&&(t=e);return t}getCellWithHighestPheromone(i,t){let e;return i.forEach(s=>{(null==e||s.getPheromone(l[t])>e.getPheromone(l[t]))&&(e=s)}),e}update(i){i/=1e3,this.hasFood||(this.desiredDirection=this.desiredDirection.addVector2D(v.d.randomInsideUnitCircle.multiplyByScalar(.1)).normalized);const r=this.desiredDirection.multiplyByScalar(this.maxSpeed).subtractVector2D(this.velocity).multiplyByScalar(2).clampMagnitude(2);this.velocity=this.velocity.addVector2D(r.multiplyByScalar(i)).clampMagnitude(this.maxSpeed)}keepWithinBounds(){const t=this.maxSpeed,e=this.getPosition(),n=window.innerWidth-0,d=window.innerHeight-0;e.x<0?this.desiredDirection.x=t:e.x>n&&(this.desiredDirection.x=-t),e.y<0?this.desiredDirection.y=t:e.y>d&&(this.desiredDirection.y=-t)}dropPheromones(i){if(!this.hasFood&&this.worldManager.isOnFood(this.getPosition())&&(this.hasFood=!0),this.hasFood&&this.worldManager.isOnNest(this.getPosition())&&(this.hasFood=!1),this.timeSincePheromoneDrop+=i,this.timeSincePheromoneDrop>=this.dropPheromoneDelay)if(this.timeSincePheromoneDrop=0,this.hasFood){const t=this.worldManager.isOnFood(this.getPosition());this.dropPheromone(t,l.Food)}else{const t=this.worldManager.isOnNest(this.getPosition());this.dropPheromone(t,l.Nest)}}dropPheromone(i,t){const e=this.worldManager.grid.getCell(this.getPosition());let s=0;if(i)s=this.worldManager.grid.pheromoneMax;else{const n=this.worldManager.grid.getNeighborCells(e);let r=0;n.forEach(d=>{d.getPheromone(t)>r&&(r=d.getPheromone(t))}),s=.98*r-e.getPheromone(t)}s>0&&e.addPheromone(t,s)}}var S=g(4889);let D=(()=>{class h{constructor(t,e,s){this.assetManager=t,this.demoCanvas=e,this.worldManager=s,this.ANT_COUNT=100,this.ants=[]}createAnts(){const t=this.assetManager.antSprite;this.ants=[];for(let e=0;e<this.ANT_COUNT;e++){const s=new Z(t,this.worldManager);this.ants.push(s),this.demoCanvas.addChildToStage(s)}}update(t){if(null!=this.previousTimeStamp){const e=t-this.previousTimeStamp;this.ants.forEach(s=>{s.move(e),s.dropPheromones(e)})}this.previousTimeStamp=t}reset(){this.ants.forEach(t=>{t.init()})}}return h.\u0275fac=function(t){return new(t||h)(o.LFG(S.me),o.LFG(P.B),o.LFG(T))},h.\u0275prov=o.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})();const R=PIXI.Loader.shared;let N=(()=>{class h{constructor(t,e,s){this.demoCanvas=t,this.worldManager=e,this.antManager=s}init(){this.initWorldManager(),this.initAntManager()}initWorldManager(){this.worldManager.init()}initAntManager(){this.antManager.createAnts()}update(t){this.worldManager.update(t),this.antManager.update(t)}unloadResources(){R.reset()}onResetClicked(){this.antManager.reset(),this.worldManager.reset()}onSliderClicked(t){this.worldManager.onSliderClicked(t)}toggleFullscreen(){this.demoCanvas.toggleFullscreen()}onTouch(t){const e=this.worldManager.grid;e.getCell(new f.W(t.offsetX,t.offsetY)).setPheromone(l.Food,e.pheromoneMax)}}return h.\u0275fac=function(t){return new(t||h)(o.Y36(P.B),o.Y36(T),o.Y36(D))},h.\u0275cmp=o.Xpm({type:h,selectors:[["app-ants"]],decls:34,vars:0,consts:[["id","bottom-ui-wrapper",1,"bottom-ui-wrapper"],[1,"sm-visible-block","sm:w-auto"],["id","reset-button",1,"reset-button",3,"click"],["id","bottom-ui-slider-wrapper",1,"bottom-ui-slider-wrapper"],[1,"slider-wrapper"],["for","decay",1,"slider-label"],["type","range","min","0","max","100","value","50","name","decay","id","decay-slider",1,"slider",3,"input"],["for","diffusion",1,"slider-label"],["type","range","min","0","max","100","value","50","name","diffusion","id","diffusion-slider",1,"slider",3,"input"],[1,"relative"],["id","invisible-reset-button"],[1,"reset-button"],[1,"fullscreen-toggle","sm-visible-block","sm:absolute","sm:right-0","sm:bottom-0"],[1,"icon-link","cursor-pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 24 24","aria-labelledby","ants-fullscreen-toggle-title",1,"fill-demo-ui"],["id","ants-fullscreen-toggle-title"],["d","M24 9h-2v-7h-7v-2h9v9zm-9 15v-2h7v-7h2v9h-9zm-15-9h2v7h7v2h-9v-9zm9-15v2h-7v7h-2v-9h9z"],["id","bottom-buttons",1,"mx-4","mt-8","flex","sm:hidden","justify-between"],[1,"sm-hidden-block"],[1,"fullscreen-toggle","my-auto"],["xmlns","http://www.w3.org/2000/svg","width","36","height","36","viewBox","0 0 24 24","aria-labelledby","ants-fullscreen-toggle-title2",1,"fill-demo-ui"],["id","ants-fullscreen-toggle-title2"],["id","color-holder",1,"hidden","bg-demo-ui","text-gray-600"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"button",2),o.NdJ("click",function(){return e.onResetClicked()}),o._uU(3,"Reset"),o.qZA(),o.qZA(),o.TgZ(4,"div",3),o.TgZ(5,"div",4),o.TgZ(6,"label",5),o._uU(7,"Decay"),o.qZA(),o.TgZ(8,"input",6),o.NdJ("input",function(n){return e.onSliderClicked(n)}),o.qZA(),o.qZA(),o.TgZ(9,"div",4),o.TgZ(10,"label",7),o._uU(11,"Diffusion"),o.qZA(),o.TgZ(12,"input",8),o.NdJ("input",function(n){return e.onSliderClicked(n)}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(13,"div",9),o.TgZ(14,"div",10),o.TgZ(15,"button",11),o._uU(16,"Reset"),o.qZA(),o.qZA(),o.TgZ(17,"div",12),o.TgZ(18,"a",13),o.NdJ("click",function(){return e.toggleFullscreen()}),o.O4$(),o.TgZ(19,"svg",14),o.TgZ(20,"title",15),o._uU(21,"A button to toggle the full screen mode of this simulation "),o.qZA(),o._UZ(22,"path",16),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.kcU(),o.TgZ(23,"div",17),o.TgZ(24,"div",18),o.TgZ(25,"button",2),o.NdJ("click",function(){return e.onResetClicked()}),o._uU(26,"Reset"),o.qZA(),o.qZA(),o.TgZ(27,"div",19),o.TgZ(28,"a",13),o.NdJ("click",function(){return e.toggleFullscreen()}),o.O4$(),o.TgZ(29,"svg",20),o.TgZ(30,"title",21),o._uU(31,"A button to toggle the full screen mode of this simulation "),o.qZA(),o._UZ(32,"path",16),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.kcU(),o._UZ(33,"div",22),o.qZA())},styles:[""]}),h})()}}]);